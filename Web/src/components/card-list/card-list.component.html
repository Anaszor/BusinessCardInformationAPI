<div class="container mx-auto p-4 md:p-8">
    <header class="flex flex-col md:flex-row justify-between items-center mb-8 gap-4">
        <h1 class="text-4xl font-bold text-slate-800">Business Cards</h1>
        <div class="flex items-center gap-2 md:gap-4">
            <div class="relative">
                <input [formControl]="filterControl"
                       type="text"
                       placeholder="Filter cards..."
                       class="pl-10 pr-4 py-2 border rounded-full w-full md:w-64 focus:ring-2 focus:ring-sky-500 focus:outline-none transition" />
                <svg class="w-5 h-5 text-slate-400 absolute top-1/2 left-3 -translate-y-1/2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                </svg>
            </div>
            <a routerLink="/cards/new" class="inline-flex items-center justify-center px-4 py-2 bg-sky-600 text-white font-semibold rounded-full hover:bg-sky-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-sky-500 transition-colors shadow-md">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd" />
                </svg>
                Add Card
            </a>
        </div>
    </header>

    <div class="flex justify-end gap-2 mb-8">
        <button (click)="exportCsv()" class="text-sm px-3 py-1 bg-white border border-slate-300 text-slate-700 rounded-md hover:bg-slate-100 transition-colors">Export CSV</button>
        <button (click)="exportXml()" class="text-sm px-3 py-1 bg-white border border-slate-300 text-slate-700 rounded-md hover:bg-slate-100 transition-colors">Export XML</button>
    </div>

    <!-- ✅ Use async pipe for Observable -->
    <ng-container *ngIf="filteredCards$ | async as cards; else loading">
        <ng-container *ngIf="cards.length > 0; else noResults">
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">
                <app-business-card *ngFor="let card of cards; trackBy: trackByCardId"
                                   [card]="card"
                                   (delete)="handleDelete(card.id)">
                </app-business-card>
            </div>
        </ng-container>
    </ng-container>

    <ng-template #loading>
        <div class="text-center py-16 text-slate-500">Loading business cards...</div>
    </ng-template>

    <ng-template #noResults>
        <div class="text-center py-16 px-8 bg-white rounded-lg shadow-md">
            <svg xmlns="http://www.w3.org/2000/svg" class="mx-auto h-16 w-16 text-slate-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1">
                <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
            <h3 class="mt-4 text-xl font-semibold text-slate-800">No Cards Found</h3>
            <p class="mt-2 text-slate-500">
                There are no business cards that match your search.
            </p>
            <a routerLink="/cards/new" class="mt-6 inline-block px-6 py-2 bg-sky-600 text-white font-semibold rounded-full hover:bg-sky-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-sky-500 transition-colors">
                Create New Card
            </a>
        </div>
    </ng-template>
</div>
